<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>发布到GitHub</title>
  <script type="text/javascript" src="../js/syntaxhighlighter.js"></script>
  <link type="text/css" rel="stylesheet" href="../css/monokai.css">
</head>
<body>
<script type="text/syntaxhighlighter" class="brush: aar"><![CDATA[
// 发布到GitHub
// ${name: publishGithub}
// ${title: 发布到GitHub}
import console;
import crypt.bin; 
import web.rest.jsonClient

var http = web.rest.jsonClient();
var aardio = http.api("https://api.github.com/repos/suiang/aardio/contents/","PUT");
http.addHeaders = {
	["Authorization"] = "token xxxxxxxxxxxxxxxxxxxxxxx"
}

var info = aardio.code["test.txt"].get();
http.beforeStringifyRequestParameters = function(params){	
	if(info[["sha"]]) params.sha = info[["sha"]];
	return params; 
}
var putData = {
	message = "updata test.txt";
	content = crypt.bin.encodeBase64( string.load("E:\Users\Desktop\test.txt") )
}
var ret = aardio.code["test.txt"].post( putData )
console.dumpJson( ret )

console.pause(true);


// https://suiang.cn/aardio/code/publishGithub.html
]]></script>
</body>
</html>
